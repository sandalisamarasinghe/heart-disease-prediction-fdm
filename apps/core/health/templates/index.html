<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
	<title>Heart Disease Prediction System</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="UTF-8" />
	<meta name="description" content="Advanced Heart Disease Prediction System using Machine Learning" />
	<meta name="keywords" content="heart disease, prediction, machine learning, health, medical" />
	
	<!-- Modern Fonts -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">

	<!-- Site Icon (Heart) -->
	<link rel="icon" type="image/svg+xml" href="{% static 'images/heart-favicon.svg' %}">
	<link rel="shortcut icon" href="{% static 'images/heart-favicon.svg' %}">
	
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
	
	<!-- Custom Modern CSS -->
	<link rel="stylesheet" href="{% static 'css/modern-style.css' %}" type="text/css" media="all" />
	
	<!-- DataTables CSS -->
	<link rel='stylesheet' type='text/css' href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">
	<link rel='stylesheet' type='text/css' href="https://cdn.datatables.net/buttons/1.6.2/css/buttons.dataTables.min.css">
	
	<!-- jQuery and DataTables -->
	<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
	<script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/1.6.2/js/dataTables.buttons.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
	<script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.html5.min.js"></script>
	
	<!-- Bootstrap JavaScript -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

	<script>
	$(document).ready(function() {
		$('#example').DataTable( {
			dom: 'Bfrtip',
			buttons: [
				'copyHtml5',
				'excelHtml5',
				'csvHtml5',
				'pdfHtml5'
			]
		} );
		
		// Responsive behavior handling
		function handleResize() {
			const width = window.innerWidth;
			const navMenu = document.querySelector('.nav-menu');
			const headerContent = document.querySelector('.header-content');
			const container = document.querySelector('.container, .container-fluid');
			const heroSection = document.querySelector('.hero-section');
			const cards = document.querySelectorAll('.card-modern');
			const forms = document.querySelectorAll('.form-modern');
			
			// Force full width usage on very small screens
			if (width <= 400) {
				document.body.style.width = '100%';
				document.body.style.maxWidth = '100%';
				document.body.style.overflowX = 'hidden';
				
				if (container) {
					container.style.width = '100%';
					container.style.maxWidth = '100%';
					container.style.padding = '0';
					container.style.margin = '0';
				}
				
				if (heroSection) {
					heroSection.style.width = '100%';
					heroSection.style.maxWidth = '100%';
					heroSection.style.padding = '0.5rem 0.25rem';
					heroSection.style.margin = '0';
					heroSection.style.textAlign = 'left';
				}
				
				// Adjust all cards and forms
				cards.forEach(card => {
					card.style.width = '100%';
					card.style.maxWidth = '100%';
					card.style.padding = '0.5rem';
					card.style.margin = '0.25rem 0';
				});
				
				forms.forEach(form => {
					form.style.width = '100%';
					form.style.maxWidth = '100%';
					form.style.padding = '0.5rem';
					form.style.margin = '0.25rem 0';
				});
			}
			
			// Adjust navigation for mobile
			if (width <= 768) {
				if (navMenu) {
					navMenu.style.flexDirection = 'column';
					navMenu.style.width = '100%';
					navMenu.style.justifyContent = 'stretch';
				}
				if (headerContent) {
					headerContent.style.flexDirection = 'column';
					headerContent.style.gap = '1rem';
				}
				
				// Ensure content takes full width
				if (heroSection) {
					heroSection.style.textAlign = 'left';
					heroSection.style.padding = '1rem 0.5rem';
				}
				
				// Stack buttons vertically
				const heroButtons = document.querySelector('.hero-buttons');
				if (heroButtons) {
					heroButtons.style.flexDirection = 'column';
					heroButtons.style.width = '100%';
					heroButtons.style.alignItems = 'stretch';
				}
				
				// Make buttons full width
				const buttons = document.querySelectorAll('.btn-modern');
				buttons.forEach(btn => {
					btn.style.width = '100%';
					btn.style.maxWidth = 'none';
					btn.style.textAlign = 'center';
				});
			} else {
				if (navMenu) {
					navMenu.style.flexDirection = 'row';
					navMenu.style.width = 'auto';
				}
				if (headerContent) {
					headerContent.style.flexDirection = 'row';
					headerContent.style.gap = '0';
				}
				
				// Reset hero section
				if (heroSection) {
					heroSection.style.textAlign = 'center';
					heroSection.style.padding = '3rem 2rem';
				}
				
				// Reset buttons
				const heroButtons = document.querySelector('.hero-buttons');
				if (heroButtons) {
					heroButtons.style.flexDirection = 'row';
					heroButtons.style.width = 'auto';
					heroButtons.style.alignItems = 'center';
				}
				
				const buttons = document.querySelectorAll('.btn-modern');
				buttons.forEach(btn => {
					btn.style.width = 'auto';
					btn.style.maxWidth = 'none';
				});
			}
			
			// Adjust table responsiveness
			const tables = document.querySelectorAll('.table-responsive');
			tables.forEach(table => {
				if (width <= 768) {
					table.style.overflowX = 'auto';
					table.style.webkitOverflowScrolling = 'touch';
					table.style.width = '100%';
				} else {
					table.style.overflowX = 'visible';
				}
			});
			
			// Adjust form layout
			const formRows = document.querySelectorAll('.form-modern .row');
			formRows.forEach(row => {
				if (width <= 992) {
					row.style.flexDirection = 'column';
				} else {
					row.style.flexDirection = 'row';
				}
			});
			
			// Ensure proper spacing on all screen sizes
			if (width <= 576) {
				if (container) {
					container.style.padding = '0 0.25rem';
				}
				
				cards.forEach(card => {
					card.style.padding = '0.75rem';
					card.style.margin = '0.25rem 0';
				});
				
				forms.forEach(form => {
					form.style.padding = '0.75rem';
					form.style.margin = '0.25rem 0';
				});
			} else if (width <= 768) {
				if (container) {
					container.style.padding = '0 0.5rem';
				}
				
				cards.forEach(card => {
					card.style.padding = '1rem';
					card.style.margin = '0.5rem 0';
				});
				
				forms.forEach(form => {
					form.style.padding = '1rem';
					form.style.margin = '0.5rem 0';
				});
			}
		}
		
		// Handle initial load
		handleResize();
		
		// Handle window resize
		window.addEventListener('resize', handleResize);
		
		// Handle orientation change
		window.addEventListener('orientationchange', function() {
			setTimeout(handleResize, 100);
		});
		
		// Ensure proper mobile navigation
		$('.nav-link').on('click', function() {
			if (window.innerWidth <= 768) {
				// Close mobile menu if needed
				const navMenu = document.querySelector('.nav-menu');
				if (navMenu && navMenu.classList.contains('mobile-open')) {
					navMenu.classList.remove('mobile-open');
				}
			}
		});
		
		// Add touch support for mobile
		if ('ontouchstart' in window) {
			document.body.classList.add('touch-device');
		}
	});
	</script>
</head>

<body>
	<!-- Theme Toggle Button -->
	<button class="theme-toggle" id="themeToggle" title="Toggle Theme">
		<i class="fas fa-moon icon" id="themeIcon"></i>
		<span id="themeText">Dark Mode</span>
	</button>

	<!-- Logout Button - Top Right Corner -->
	{% if request.user.is_authenticated and request.resolver_match.url_name != 'login' and request.resolver_match.url_name != 'login_admin' and request.resolver_match.url_name != 'signup' %}
	<div class="logout-top-right">
		<a class="btn-modern btn-danger logout-soft" href="{% url 'logout' %}" title="Logout">
			<i class="fas fa-sign-out-alt"></i> Logout
		</a>
	</div>
	{% else %}
	<!-- Show Login Button in Top Right for Non-Authenticated Users -->
	<div class="logout-top-right">
		<a class="btn-modern btn-primary" href="{% url 'login' %}" title="Login">
			<i class="fas fa-sign-in-alt"></i> Login
		</a>
	</div>
	{% endif %}

	<!-- Bootstrap Navbar -->
	<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
		<div class="container">
			<a class="navbar-brand d-flex align-items-center" href="{% url 'home' %}">
				<span class="me-2" style="display:inline-flex;width:36px;height:36px;border-radius:10px;align-items:center;justify-content:center;background:var(--primary-color);color:#fff;"><i class="fas fa-heartbeat"></i></span>
				<div>
					<div class="fw-bold" style="line-height:1;">Heart Disease Prediction</div>
					<small class="text-muted">AI-Powered Medical Diagnosis</small>
				</div>
			</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar" aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="mainNavbar">
				<ul class="navbar-nav me-auto mb-2 mb-lg-0">
					<li class="nav-item"><a class="nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}" href="{% url 'home' %}">Home</a></li>
					{% if request.user.is_authenticated %}
					<li class="nav-item"><a class="nav-link" href="/add_heartdetail/">Predict Disease</a></li>
					{% endif %}
				</ul>
			</div>
		</div>
	</nav>

	<!-- Main Content -->
	<main>
		{% block body %}
		<!-- Default content for index page -->
		<div class="hero-section">
			<div class="container">
				<h1 class="hero-title">Heart Disease Prediction System</h1>
				<p class="hero-subtitle">
					Advanced AI-powered medical diagnosis using machine learning algorithms to predict heart disease risk with high accuracy.
				</p>
				<div class="d-flex gap-3 justify-content-center flex-wrap">
                    {% if request.user.is_authenticated %}
                    <a href="{% url 'prediction_form' %}" class="btn-modern btn-primary">
						<i class="fas fa-heartbeat"></i> Get Started
					</a>
                    {% else %}
                    <a href="{% url 'login' %}?next={% url 'prediction_form' %}" class="btn-modern btn-primary">
						<i class="fas fa-sign-in-alt"></i> Get Started
					</a>
					{% endif %}
                    <a href="{% url 'about' %}" class="btn-modern btn-secondary">
						<i class="fas fa-info-circle"></i> Learn More
					</a>
				</div>
			</div>
		</div>

		<div class="container mb-5">
			<div class="row">
				<div class="col-md-4 mb-4">
					<div class="card-modern text-center">
						<div class="card-header">
							<i class="fas fa-brain fa-3x text-primary mb-3"></i>
							<h3 class="card-title">AI-Powered Analysis</h3>
							<p class="card-subtitle">Advanced machine learning algorithms analyze your health data</p>
						</div>
					</div>
				</div>
				<div class="col-md-4 mb-4">
					<div class="card-modern text-center">
						<div class="card-header">
							<i class="fas fa-chart-line fa-3x text-success mb-3"></i>
							<h3 class="card-title">High Accuracy</h3>
							<p class="card-subtitle">Proven accuracy rates exceeding 80% in disease prediction</p>
						</div>
					</div>
				</div>
				<div class="col-md-4 mb-4">
					<div class="card-modern text-center">
						<div class="card-header">
							<i class="fas fa-shield-alt fa-3x text-warning mb-3"></i>
							<h3 class="card-title">Secure & Private</h3>
							<p class="card-subtitle">Your health data is encrypted and completely secure</p>
						</div>
					</div>
				</div>
			</div>
		</div>
		{% endblock %}
	</main>

	<!-- Modern Footer -->
	<footer class="footer-modern">
		<div class="footer-content">
			<div class="footer-section">
				<h3>About Us</h3>
				<p>We are dedicated to providing accurate heart disease prediction using cutting-edge machine learning technology to improve healthcare outcomes.</p>
			</div>
			<div class="footer-section">
				<h3>Quick Links</h3>
				<p><a href="{% url 'about' %}" style="color: #B0BEC5;">About</a></p>
				<p><a href="{% url 'contact' %}" style="color: #B0BEC5;">Contact</a></p>
				
				<p><a href="{% url 'login_admin' %}" style="color: #B0BEC5;">Admin Login</a></p>
			</div>
			<div class="footer-section">
				<h3>Contact Info</h3>
				<p><i class="fas fa-building me-2"></i> Heart.org</p>
				<p><i class="fas fa-envelope me-2"></i> heartdiseaseprediction@gmail.com</p>
				<p><i class="fas fa-phone me-2"></i> +94 71 111 1111</p>
				<p><i class="fas fa-map-marker-alt me-2"></i> 17/8, Pittugala, Malabe</p>
			</div>
		</div>
		<div class="footer-bottom">
			<p>&copy; 2025 Heart Disease Prediction System. All rights reserved | FDM Mini Project 2025</p>
		</div>
	</footer>

	<!-- Scroll to Top Button -->
	

	<!-- Theme Toggle JavaScript -->
	<script>
		// Theme Toggle Functionality
		document.addEventListener('DOMContentLoaded', function() {
			const themeToggle = document.getElementById('themeToggle');
			const themeIcon = document.getElementById('themeIcon');
			const themeText = document.getElementById('themeText');
			
			// Check for saved theme preference or default to light
			const currentTheme = localStorage.getItem('theme') || 'light';
			document.documentElement.setAttribute('data-theme', currentTheme);
			updateThemeUI(currentTheme);
			
			// Theme toggle click handler
			themeToggle.addEventListener('click', function() {
				const currentTheme = document.documentElement.getAttribute('data-theme');
				const newTheme = currentTheme === 'light' ? 'dark' : 'light';
				
				// Apply new theme
				document.documentElement.setAttribute('data-theme', newTheme);
				localStorage.setItem('theme', newTheme);
				
				// Update UI
				updateThemeUI(newTheme);
				
				// Add smooth transition effect
				document.body.style.transition = 'all 0.3s ease';
				
				// Show theme change notification
				showThemeNotification(newTheme);
			});
			
			function updateThemeUI(theme) {
				if (theme === 'dark') {
					themeIcon.className = 'fas fa-sun icon';
					themeText.textContent = 'Light Mode';
					themeToggle.title = 'Switch to Light Mode';
				} else {
					themeIcon.className = 'fas fa-moon icon';
					themeText.textContent = 'Dark Mode';
					themeToggle.title = 'Switch to Dark Mode';
				}
			}
			
			function showThemeNotification(theme) {
				// Create notification element
				const notification = document.createElement('div');
				notification.className = 'theme-notification';
				notification.innerHTML = `
					<i class="fas fa-${theme === 'dark' ? 'moon' : 'sun'} me-2"></i>
					Switched to ${theme === 'dark' ? 'Dark' : 'Light'} Mode
				`;
				
				// Add styles
				notification.style.cssText = `
					position: fixed;
					top: 80px;
					right: 20px;
					background: var(--gradient-primary);
					color: var(--text-light);
					padding: 12px 20px;
					border-radius: 25px;
					box-shadow: var(--shadow-medium);
					z-index: 9999;
					transform: translateX(100%);
					transition: transform 0.3s ease;
					font-weight: 600;
					backdrop-filter: blur(10px);
				`;
				
				document.body.appendChild(notification);
				
				// Animate in
				setTimeout(() => {
					notification.style.transform = 'translateX(0)';
				}, 100);
				
				// Remove after 3 seconds
				setTimeout(() => {
					notification.style.transform = 'translateX(100%)';
					setTimeout(() => {
						document.body.removeChild(notification);
					}, 300);
				}, 3000);
			}
		});
	</script>
	
	<style>
		/* Logout button positioning */
		.logout-top-right {
			position: fixed;
			top: 80px;
			right: 20px;
			z-index: 9999;
			background: rgba(255, 255, 255, 0.95);
			padding: 8px;
			border-radius: 15px;
			box-shadow: 0 6px 20px rgba(0,0,0,0.4);
			border: 2px solid #007bff;
		}
		
		.logout-top-right .btn-modern {
			padding: 8px 16px;
			font-size: 14px;
			border-radius: 25px;
			box-shadow: 0 4px 12px rgba(0,0,0,0.15);
			transition: all 0.3s ease;
		}
		
		.logout-top-right .btn-modern:hover {
			transform: translateY(-2px);
			box-shadow: 0 6px 16px rgba(0,0,0,0.2);
		}
	</style>
	
	<script>
		// Responsive handling
		$(document).ready(function() {
			// Handle window resize
			$(window).on('resize', function() {
				adjustLayout();
			});
			
			// Handle orientation change
			$(window).on('orientationchange', function() {
				setTimeout(adjustLayout, 100);
			});
			
			function adjustLayout() {
				const width = $(window).width();
				const height = $(window).height();
				
				// Adjust navigation for small screens
				if (width <= 768) {
					$('.navbar-nav').addClass('flex-column');
					$('.nav-link').addClass('text-center');
				} else {
					$('.navbar-nav').removeClass('flex-column');
					$('.nav-link').removeClass('text-center');
				}
				
				// Adjust tables for small screens
				if (width <= 576) {
					$('.table').addClass('table-sm');
					$('.table-responsive').addClass('overflow-auto');
				}
				
				// Adjust forms for small screens
				if (width <= 480) {
					$('.form-control').addClass('form-control-sm');
					$('.btn').addClass('btn-sm');
				}
				
				// Ensure content fills available width
				$('.container, .container-fluid').css({
					'max-width': '100%',
					'padding': '0 0.5rem'
				});
				
				// Remove excessive centering on small screens
				if (width <= 768) {
					$('.hero-section').css('text-align', 'left');
					$('.hero-content h1, .hero-content p').css('text-align', 'left');
					$('.hero-buttons').css({
						'justify-content': 'flex-start',
						'align-items': 'stretch'
					});
				}
			}
			
			// Initial adjustment
			adjustLayout();
		});
	</script>
</body>
</html>